@page "/TestComponent"
@inject IJSRuntime JSRuntime
@using System.Net.Http.Json
@using FinancialApp.Data
@using Newtonsoft.Json
@inject HttpClient Http
@inject Microsoft.AspNetCore.Components.NavigationManager navigation
@inject NavigationManager NavigationManager
@using System.Reflection

@if (listing.GeneralAccountEntries == null)
{
    <div class="spinner-border text-danger" role="status">
        <span class="visually-hidden">Loading...</span>
    </div>
}
else
{
    <h3>TEST TEST TEST</h3>
    <SelectSearch SelectSearchLabel="TestComponent" Items=@softaccountListing @bind-SelectedItemKey="record.FromAccountId"></SelectSearch>
    
    
    <label asp-for="description" class="control-label">Boud: @record.FromAccountId</label>


}

@code{

    public Dictionary<string, string> DictTest = new Dictionary<string, string> ();
    public Dictionary<string, string> DictSelect = new Dictionary<string, string> ();

    private GeneralAccountEntry selectedGenAcct = new GeneralAccountEntry();
    private AccountEntry selectedSoftAcct = new AccountEntry();
    public ListingsResponse listing = new ListingsResponse();
    public AccountEntry[] softaccountListing;
    public Transaction record = new Transaction();
    MemberInfo[] memberInfo;

    protected override async Task OnInitializedAsync()
    {

        HttpResponseMessage response = await Http.GetAsync("http://localhost:7071/api/listings");
        string responseBody = await response.Content.ReadAsStringAsync();
        listing = JsonConvert.DeserializeObject<ListingsResponse>(responseBody);

        selectedGenAcct = listing.GeneralAccountEntries[0];
        softaccountListing = selectedGenAcct.SoftAccountList;

        DictTest.Add("testk1", "testV1");
        DictTest.Add("testk2", "testV2");
        DictTest.Add("testk3", "testV3");

    }

    

}
